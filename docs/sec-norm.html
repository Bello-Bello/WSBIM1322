<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 5 Data normalisation: centring, scaling, quantile normalisation | Bioinformatics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain." />


<meta name="author" content="Laurent Gatto" />

<meta name="date" content="2019-10-21" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain.">

<title>Chapter 5 Data normalisation: centring, scaling, quantile normalisation | Bioinformatics</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Bioinformatics<p><p class="author">Laurent Gatto</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preamble</a>
<a href="sec-refresher.html"><span class="toc-section-number">1</span> R refresher</a>
<a href="sec-vis.html"><span class="toc-section-number">2</span> Data visualisation</a>
<a href="sec-obj.html"><span class="toc-section-number">3</span> High-level data structures</a>
<a href="sec-biostrings.html"><span class="toc-section-number">4</span> Manipulating sequences with Biostrings</a>
<a id="active-page" href="sec-norm.html"><span class="toc-section-number">5</span> Data normalisation: centring, scaling, quantile normalisation</a><ul class="toc-sections">
<li class="toc"><a href="#introduction-2"> Introduction</a></li>
<li class="toc"><a href="#data-transformation"> Data transformation</a></li>
<li class="toc"><a href="#centring-and-scaling"> Centring and scaling</a></li>
</ul>
<a href="sec-mlintro.html"><span class="toc-section-number">6</span> Introduction to statistical machine learning</a>
<a href="sec-testing.html"><span class="toc-section-number">7</span> Hypothesis testing</a>
<a href="sec-ul.html"><span class="toc-section-number">8</span> Unsupervised learning</a>
<a href="sec-dimred.html"><span class="toc-section-number">9</span> Dimensionality reduction</a>
<a href="sec-sl.html"><span class="toc-section-number">10</span> Supervised learning</a>
<a href="sec-biovis.html"><span class="toc-section-number">11</span> Visualising biomolecular data</a>
<a href="sec-ccl.html"><span class="toc-section-number">12</span> Conclusions</a>
<a href="sec-si.html"><span class="toc-section-number">13</span> Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="sec:norm" class="section level1">
<h1>
<span class="header-section-number">Chapter 5</span> Data normalisation: centring, scaling, quantile normalisation</h1>
<p><strong>Learning objectives</strong></p>
<ul>
<li>What is data normalisation and why do we need it?</li>
<li>What are centring and scaling?</li>
<li>What is quantile normalisation?</li>
<li>How to assess if normalisation worked.</li>
</ul>
<div id="introduction-2" class="section level2">
<h2>
<span class="header-section-number">5.1</span> Introduction</h2>
<p>In a typical high throughput experiment, we assay thousands of
features (gene transcripts, proteins, metabolites, …) is a certain
number of biologically diverse samples (from about 6 to hundreds of
thousands).</p>
<p>But what do you think would happen is we took the same sample, such as
a suspension of U2OS cells (a cell line stemming from bone cancer),
split it in two, and measured it twice using the exact same protocol?
Will the measurements be exactly identical? Why? These would be
<strong>technical replicates</strong>.</p>
<p>If we now take two independent different cell cultures of the same
cell line, do you expect there to be larger, similar or smaller
difference than in the examples above? One would refer to <strong>biological
replicates</strong> in this case.</p>
<!-- - See technical replication in RNA-Seq paper from Irizayry group. -->
<!-- - Find some data with tech and bio reps. -->
<p>Experiments aim at measuring biological variability by comparing
biological conditions in a controlled setting. The be able to measure
any biologically signal in the data, the biological variability must
be larger than the technical variability.</p>
</div>
<div id="data-transformation" class="section level2">
<h2>
<span class="header-section-number">5.2</span> Data transformation</h2>
</div>
<div id="centring-and-scaling" class="section level2">
<h2>
<span class="header-section-number">5.3</span> Centring and scaling</h2>
<div id="generating-data" class="section level3">
<h3>
<span class="header-section-number">5.3.1</span> Generating data</h3>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>We are going to start by generating a data set to precisely illustrate
the effect of the methods.</p>
<ol style="list-style-type: decimal">
<li><p>Use the <code>rnorm()</code> function to generate a distribution of 1000
values centred around 0 and with a standard deviation
of 2. Visualise these data.</p></li>
<li><p>Generate four such distribution with parameters <em>N(6, 2)</em>,
<em>N(4,2)</em>, <em>N(4, 1)</em>, <em>N(7, 3)</em> and create a matrix or dataframe
with rownames <code>gene1</code> to <code>gene1000</code> and colnames <code>sample1</code> to
<code>sample4</code>. Visualise these data and discuss whether these samples
could be compared against each other. Do assure replication of this
simulation, set the random number generation seed to 123.</p></li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-27" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-27', 'sol-start-27')"></span>
</p>
<div id="sol-body-27" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="sec-norm.html#cb194-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb194-2"><a href="sec-norm.html#cb194-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb194-3"><a href="sec-norm.html#cb194-3"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample1 =</span> <span class="kw">rnorm</span>(n, <span class="dv">6</span>, <span class="dv">2</span>),</span>
<span id="cb194-4"><a href="sec-norm.html#cb194-4"></a>                <span class="dt">sample2 =</span> <span class="kw">rnorm</span>(n, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb194-5"><a href="sec-norm.html#cb194-5"></a>                <span class="dt">sample3 =</span> <span class="kw">rnorm</span>(n, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb194-6"><a href="sec-norm.html#cb194-6"></a>                <span class="dt">sample4 =</span> <span class="kw">rnorm</span>(n, <span class="dv">7</span>, <span class="dv">3</span>))</span>
<span id="cb194-7"><a href="sec-norm.html#cb194-7"></a><span class="kw">head</span>(x)</span></code></pre></div>
<pre><code>##    sample1   sample2  sample3   sample4
## 1 4.879049  2.008403 3.488396  6.549078
## 2 5.539645  1.920090 4.236938  6.016729
## 3 9.117417  3.964040 3.458411  2.655504
## 4 6.141017  3.735650 5.219228  4.908146
## 5 6.258575 -1.098686 4.174136 14.795471
## 6 9.430130  6.081147 3.384732  6.887755</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="sec-norm.html#cb196-1"></a><span class="kw">boxplot</span>(x)</span></code></pre></div>
<p><img src="WSBIM1322_files/figure-html/sln1-1.png" width="672"></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Centring refers to the action of modifying the mean value of a set of
values by subtracting a fixed value from each individual value. On the
figure above, this equates to shifting the values up to down. A
typical value is the mean of all the data to be centred.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>For each column, calculate its mean value and subtract it from the
values. Visualise and interpret the centred data.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-28" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-28', 'sol-start-28')"></span>
</p>
<div id="sol-body-28" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="sec-norm.html#cb197-1"></a>cmns &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb197-2"><a href="sec-norm.html#cb197-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(x))</span>
<span id="cb197-3"><a href="sec-norm.html#cb197-3"></a>    x[, i] &lt;-<span class="st"> </span>x[, i] <span class="op">-</span><span class="st"> </span>cmns[i]</span>
<span id="cb197-4"><a href="sec-norm.html#cb197-4"></a><span class="kw">boxplot</span>(x)</span></code></pre></div>
<p><img src="WSBIM1322_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="sec-biostrings.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-mlintro.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2019-10-21
</p>
</div>
</div>



</body>
</html>
