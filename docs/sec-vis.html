<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 2 Data visualisation | Bioinformatics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain." />


<meta name="author" content="Laurent Gatto" />

<meta name="date" content="2019-09-06" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Course material for the Bbioinformatics (WSBIM1322) course at UCLouvain.">

<title>Chapter 2 Data visualisation | Bioinformatics</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Bioinformatics<p><p class="author">Laurent Gatto</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preamble</a>
<a href="sec-refresher.html"><span class="toc-section-number">1</span> R refresher</a>
<a id="active-page" href="sec-vis.html"><span class="toc-section-number">2</span> Data visualisation</a><ul class="toc-sections">
<li class="toc"><a href="#introduction"> Introduction</a></li>
<li class="toc"><a href="#base-plotting"> Base plotting</a></li>
<li class="toc"><a href="#the-ggplot2-package"> The <code>ggplot2</code> package</a></li>
<li class="toc"><a href="#visualising-1d-data"> Visualising 1D data</a></li>
<li class="toc"><a href="#number-of-modes"> Number of modes</a></li>
<li class="toc"><a href="#visualising-2d-data"> Visualising 2D data</a></li>
<li class="toc"><a href="#visualising-data-along-more-dimensions"> Visualising data along more dimensions</a></li>
<li class="toc"><a href="#interactive-visualisation"> Interactive visualisation</a></li>
<li class="toc"><a href="#additional-exercises"> Additional exercises</a></li>
</ul>
<a href="sec-obj.html"><span class="toc-section-number">3</span> High-level data structures</a>
<a href="sec-biostrings.html"><span class="toc-section-number">4</span> Manipulating sequences with Biostrings</a>
<a href="sec-norm.html"><span class="toc-section-number">5</span> Data normalisation: centering, scaling, quantile normalisation</a>
<a href="sec-mlintro.html"><span class="toc-section-number">6</span> Introduction to statistical learning</a>
<a href="sec-testing.html"><span class="toc-section-number">7</span> Hypothesis testing</a>
<a href="sec-ul.html"><span class="toc-section-number">8</span> Unsupervised learning</a>
<a href="sec-dimred.html"><span class="toc-section-number">9</span> Dimensionality reduction</a>
<a href="sec-sl.html"><span class="toc-section-number">10</span> Supervised learning</a>
<a href="sec-biovis.html"><span class="toc-section-number">11</span> Visualising biomolecular data</a>
<a href="sec-ccl.html"><span class="toc-section-number">12</span> Conclusions</a>
<a href="sec-si.html"><span class="toc-section-number">13</span> Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="sec:vis" class="section level1">
<h1>
<span class="header-section-number">Chapter 2</span> Data visualisation</h1>
<p>This chapter is based on Chapter 3 <a href="https://www-huber.embl.de/msmb/Chap-Graphics.html"><em>High Quality Graphics in
R</em></a> of the <em>Modern
Statistics for Modern Biology</em> book <span class="citation">(Holmes and Huber <label for="tufte-mn-11" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-11" class="margin-toggle">2019<span class="marginnote">Holmes, Susan, and Wolfgang Huber. 2019. <em>Modern Statistics for Modern Biology</em>. Cambridge Univeristy Press.</span>)</span>.</p>
<div id="introduction" class="section level2">
<h2>
<span class="header-section-number">2.1</span> Introduction</h2>
<p>The <strong>goal</strong> of data visualisation is to</p>
<ul>
<li>interactively explore and understand data, i.e. <em>exploratory data
analysis</em>;</li>
<li>to present and <em>communicate results</em>, whether as a preliminary
analysis or final results.</li>
</ul>
<p>Our <strong>learning objectives</strong> are</p>
<ul>
<li>Familiarise ourselves with plotting in R using base graphics and
<code>ggplot2</code>;</li>
<li>Understand the concepts behind the gramar of graphics and <code>ggplot2</code>;</li>
<li>Learn how to visualiste data along 1, 2 or more dimensions;</li>
<li>Learn about <code>plotly</code>, one package for ploducing interactive
visualisations.</li>
</ul>
<p>The different between this chapter, and the <a href="ttps://uclouvain-cbio.github.io/WSBIM1207/sec-vis.html"><em>Data
Visualisation</em></a>
of the introductory WSBIM1207 course is that here we focus on
understanding and communicating data through visualisation, rather
than on the syntax of the plotting packages. Here are a couple couple
of <a href="./horror.pdf"><em>visualisation horror picture show</em></a> from a lecture
by Wolfgang Huber to illustrate what not to do.</p>
<p>Let’s use the famous <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet"><em>Anscombe’s
quartet</em></a> data as
a motivating example. This data is composed of 4 pairs of
values, <span class="math inline">\((x_1, y_1)\)</span> to <span class="math inline">\((x_4, y_4)\)</span>:</p>
<table>
<thead><tr class="header">
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">x3</th>
<th align="right">x4</th>
<th align="right">y1</th>
<th align="right">y2</th>
<th align="right">y3</th>
<th align="right">y4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">8.04</td>
<td align="right">9.14</td>
<td align="right">7.46</td>
<td align="right">6.58</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">6.95</td>
<td align="right">8.14</td>
<td align="right">6.77</td>
<td align="right">5.76</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">7.58</td>
<td align="right">8.74</td>
<td align="right">12.74</td>
<td align="right">7.71</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">9</td>
<td align="right">9</td>
<td align="right">8</td>
<td align="right">8.81</td>
<td align="right">8.77</td>
<td align="right">7.11</td>
<td align="right">8.84</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">11</td>
<td align="right">11</td>
<td align="right">8</td>
<td align="right">8.33</td>
<td align="right">9.26</td>
<td align="right">7.81</td>
<td align="right">8.47</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">8</td>
<td align="right">9.96</td>
<td align="right">8.10</td>
<td align="right">8.84</td>
<td align="right">7.04</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">8</td>
<td align="right">7.24</td>
<td align="right">6.13</td>
<td align="right">6.08</td>
<td align="right">5.25</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="right">4.26</td>
<td align="right">3.10</td>
<td align="right">5.39</td>
<td align="right">12.50</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">12</td>
<td align="right">12</td>
<td align="right">8</td>
<td align="right">10.84</td>
<td align="right">9.13</td>
<td align="right">8.15</td>
<td align="right">5.56</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">4.82</td>
<td align="right">7.26</td>
<td align="right">6.42</td>
<td align="right">7.91</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">5.68</td>
<td align="right">4.74</td>
<td align="right">5.73</td>
<td align="right">6.89</td>
</tr>
</tbody>
</table>
<p>Each of these <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> sets have the same variance, mean and
correlation:</p>
<table>
<thead><tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>var(x)</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
</tr>
<tr class="even">
<td>mean(x)</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
</tr>
<tr class="odd">
<td>var(y)</td>
<td align="right">4.1272691</td>
<td align="right">4.1276291</td>
<td align="right">4.1226200</td>
<td align="right">4.1232491</td>
</tr>
<tr class="even">
<td>mean(y)</td>
<td align="right">7.5009091</td>
<td align="right">7.5009091</td>
<td align="right">7.5000000</td>
<td align="right">7.5009091</td>
</tr>
<tr class="odd">
<td>cor(x,y)</td>
<td align="right">0.8164205</td>
<td align="right">0.8162365</td>
<td align="right">0.8162867</td>
<td align="right">0.8165214</td>
</tr>
</tbody>
</table>
<p>But…</p>
<p>While the <em>residuals</em> of the linear regression (see chapter
<a href="sec-obj.html#sec:obj">3</a>) clearly indicate fundamental differences in these
data, the most simple and straightforward approach is <em>visualisation</em>
to highlight the fundamental differences in the datasets.</p>
<p><img src="WSBIM1207_files/figure-html/anscombefig-1.png" width="672"></p>
<p>See also another, more recent example:
<a href="https://www.autodeskresearch.com/publications/samestats">The Datasaurus Dozen dataset</a>.</p>
<p><img src="https://d2f99xq7vri1nk.cloudfront.net/DinoSequentialSmaller.gif"></p>
<p>Throughout this course we will focus on producing visualisations that
will enable <strong>understanding important features</strong> of biomolecular data
or the effect of their transformation and analyses. With this in mind,
the beauty of the visualisations we will produce won’t be assessed by
how visually attractive the figures are, but how they advance our
understanding the data. In the process of data exploration and data
analysis, we want to be able to quickly generate and interpret
figures. It is of course important to polish the graphics to make them
visually appealing and improve communication with the audience, once a
useful figure has been chosen as a means of communication.</p>
<p>An important aspect of data visualisation is data <strong>manipulation</strong>,
transformation and the format of the data: as seen in
<a href="https://uclouvain-cbio.github.io/WSBIM1207/sec-dplyr.html">WSBIM1207</a>,
its scale (see below) and normalisation of the data (see chapter
<a href="sec-norm.html#sec:norm">5</a>).</p>
<p>A last feature of data that is intimately associated with its
manipulation and visualisation is its <strong>structure</strong>: long and wide
dataframes (as introduced in
<a href="https://uclouvain-cbio.github.io/WSBIM1207/sec-dplyr.html">WSBIM1207</a>
or dedicated objects (see chapter <a href="sec-obj.html#sec:obj">3</a>). Some visualisations
will be much easier when the data is formatted in a certain way.</p>
</div>
<div id="base-plotting" class="section level2">
<h2>
<span class="header-section-number">2.2</span> Base plotting</h2>
<p>The default graphics system that comes with R, often called base R
graphics is simple and fast. It is based on the painter’s model or
canvas, where different output are directly overlaid on top of each
other.</p>
<p>Below, we display the relation between the optical density of the
deoxyribonuclease (DNase) protein as measure by an enzyme-linked
immunosorbent assay (ELISA) assay for all observations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sec-vis.html#cb6-1"></a><span class="kw">head</span>(DNase)</span></code></pre></div>
<pre><code>## Grouped Data: density ~ conc | Run
##   Run       conc density
## 1   1 0.04882812   0.017
## 2   1 0.04882812   0.018
## 3   1 0.19531250   0.121
## 4   1 0.19531250   0.124
## 5   1 0.39062500   0.206
## 6   1 0.39062500   0.215</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sec-vis.html#cb8-1"></a><span class="kw">plot</span>(DNase<span class="op">$</span>con, DNase<span class="op">$</span>density)</span></code></pre></div>
<div class="figure">
<span id="fig:dnase"></span>
<p class="caption marginnote shownote">
Figure 2.1: The default base <code>plot</code> function on the <code>DNase</code> data.
</p>
<img src="WSBIM1207_files/figure-html/dnase-1.png" alt="The default base `plot` function on the `DNase` data." width="672">
</div>
<p>We can add some features on the plot, such vertical dotted lines for
all observed observations and customise the look and feel of the plot
by setting specific arguments to the <code>plot</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sec-vis.html#cb9-1"></a><span class="kw">plot</span>(DNase<span class="op">$</span>con, DNase<span class="op">$</span>density,</span>
<span id="cb9-2"><a href="sec-vis.html#cb9-2"></a>     <span class="dt">xlab =</span> <span class="st">"DNase concentration (ng/ml)"</span>,</span>
<span id="cb9-3"><a href="sec-vis.html#cb9-3"></a>     <span class="dt">ylab =</span> <span class="st">"Optical density"</span>,</span>
<span id="cb9-4"><a href="sec-vis.html#cb9-4"></a>     <span class="dt">pch =</span> <span class="dv">1</span>,</span>
<span id="cb9-5"><a href="sec-vis.html#cb9-5"></a>     <span class="dt">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb9-6"><a href="sec-vis.html#cb9-6"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">unique</span>(DNase<span class="op">$</span>conc), <span class="dt">lty =</span> <span class="st">"dotted"</span>)</span></code></pre></div>
<div class="figure">
<span id="fig:dnase2"></span>
<p class="caption marginnote shownote">
Figure 2.2: Customising a base figure using function arguments and overlaying new graphical features.
</p>
<img src="WSBIM1207_files/figure-html/dnase2-1.png" alt="Customising a base figure using function arguments and overlaying new graphical features." width="672">
</div>
<p>If we wanted to change anything to that figures, we would need to
repeat all the commands and modify accordingly. Any additinal command
would be added to the existing canvas.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>How would you produce a figure that differentiates the different runs
using base graphics?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-1" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')"></span>
</p>
<div id="sol-body-1" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sec-vis.html#cb10-1"></a><span class="kw">plot</span>(DNase<span class="op">$</span>con, DNase<span class="op">$</span>density, <span class="dt">col =</span> DNase<span class="op">$</span>Run)</span></code></pre></div>
<p><img src="WSBIM1207_files/figure-html/colbyrun-1.png" width="672"></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Use the <code>hist</code> and <code>boxplot</code> functions to produce and
histogram of all optical densities and a boxplot of the densities
split by run.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-2" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')"></span>
</p>
<div id="sol-body-2" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="sec-vis.html#cb11-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-2"><a href="sec-vis.html#cb11-2"></a><span class="kw">hist</span>(DNase<span class="op">$</span>density)</span>
<span id="cb11-3"><a href="sec-vis.html#cb11-3"></a><span class="kw">boxplot</span>(density <span class="op">~</span><span class="st"> </span>Run, DNase)</span></code></pre></div>
<div class="figure">
<p class="caption marginnote shownote">
(#fig:hist_boxplot)The base <code>hist</code> and <code>boxplot</code> functions, the latter using the formula interface.
</p>
<img src="WSBIM1207_files/figure-html/hist_boxplot-1.png" alt="The base `hist` and `boxplot` functions, the latter using the formula interface." width="1344">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The base graphics function are very effective to quickly produce out
of the box figures. However, there is not global overview and
parametrisation of the visualisation. The layout decisions have to be
made up upfront (and if not adequate, the figure needs to be redrawn)
and every aspect of the figure is customised locally as function
arguments.</p>
<p>More generally, base graphics functions will work with various inputs:
above we have worked with a <code>data.frame</code>, vectors and a formula. There
is no unified type of data across all functions which makes it
efficient for some types of data (if they match), but also very
heterogeneous in terms of interface, leading to a lot of customisation
code.</p>
<p>Finally, defaults, and colours in particular, are poorly chosen.</p>
</div>
<div id="the-ggplot2-package" class="section level2">
<h2>
<span class="header-section-number">2.3</span> The <code>ggplot2</code> package</h2>
<p><strong><code>ggplot2</code></strong> is a plotting package that makes it simple to create
complex plots from data in a data frame. It provides a more
programmatic interface for specifying what variables to plot, how they
are displayed, and general visual properties. The theoretical
foundation that supports the <code>ggplot2</code> is the <em>Grammar of
Graphics</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. Instead of producing the figure, the user defines and
assembles the visual components into an object that is the
displayed. There is a book about ggplot2<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> that provides a good
overview, but it is outdated. The ggplot2 web page
(<a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>) provides ample documentation.</p>
<p>To build a ggplot, we will use the following basic template that can
be used for different types of plots:</p>
<pre><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +  &lt;GEOM_FUNCTION&gt;()</code></pre>
<p>We need first to load the <code>ggplot2</code> package:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sec-vis.html#cb13-1"></a><span class="kw">library</span>(<span class="st">"ggplot2"</span>)</span></code></pre></div>
<ul>
<li>use the <code>ggplot()</code> function and bind the plot to a specific data frame using the
<code>data</code> argument</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sec-vis.html#cb14-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> DNase)</span></code></pre></div>
<div class="figure">
<span id="fig:gg0"></span>
<p class="caption marginnote shownote">
Figure 2.3: We have only specified the data, and there’s nothing to display yet.
</p>
<img src="WSBIM1207_files/figure-html/gg0-1.png" alt="We have only specified the data, and there's nothing to display yet." width="672">
</div>
<ul>
<li>define a mapping (using the aesthetic (<code>aes</code>) function), by
selecting the variables to be plotted and specifying how to present
them in the graph, e.g. as x/y positions or characteristics such as
size, shape, colour, etc.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sec-vis.html#cb15-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> DNase,</span>
<span id="cb15-2"><a href="sec-vis.html#cb15-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> conc, <span class="dt">y =</span> density))</span></code></pre></div>
<div class="figure">
<span id="fig:gg1"></span>
<p class="caption marginnote shownote">
Figure 2.4: <code>ggplot2</code> can now generate the axes, ticks and ranges based on the data.
</p>
<img src="WSBIM1207_files/figure-html/gg1-1.png" alt="`ggplot2` can now generate the axes, ticks and ranges based on the data." width="672">
</div>
<ul>
<li>add <em>geoms</em> – graphical representations of the data in the plot
(points, lines, bars). To add a geom to the plot use the <code>+</code>
operator. Because we have two continuous variables, let’s use
<code>geom_point()</code> first:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sec-vis.html#cb16-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> DNase,</span>
<span id="cb16-2"><a href="sec-vis.html#cb16-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> conc, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb16-3"><a href="sec-vis.html#cb16-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:gg2"></span>
<p class="caption marginnote shownote">
Figure 2.5: Final figures with rendering of the data as a scatter plot.
</p>
<img src="WSBIM1207_files/figure-html/gg2-1.png" alt="Final figures with rendering of the data as a scatter plot." width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Compare the <code>ggplot2</code> and base graphics version of the density
vs. concentration plot. Which one do you prefer, and why?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>It is possible to store the output of the <code>ggplot</code> function into a
variable that can be visualised by either typing its name in the
console or explicitly printing it (like any other variable).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sec-vis.html#cb17-1"></a>gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> DNase,</span>
<span id="cb17-2"><a href="sec-vis.html#cb17-2"></a>             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> conc, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb17-3"><a href="sec-vis.html#cb17-3"></a><span class="st">    </span><span class="kw">geom_point</span>()</span>
<span id="cb17-4"><a href="sec-vis.html#cb17-4"></a><span class="kw">print</span>(gg)</span></code></pre></div>
<div class="figure">
<span id="fig:ggobj"></span>
<p class="caption marginnote shownote">
Figure 2.6: Saving and printing an object.
</p>
<img src="WSBIM1207_files/figure-html/ggobj-1.png" alt="Saving and printing an object." width="672">
</div>
<p>Let’s immediately customise this visualisation to
- highlight how to re-use the <code>gg</code> object without repeating the
plotting code and
- how we can add additional (identical or different) <em>geoms</em> to a
plot.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sec-vis.html#cb18-1"></a>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Run))</span></code></pre></div>
<div class="figure">
<span id="fig:gg3"></span>
<p class="caption marginnote shownote">
Figure 2.7: Adding another <code>geom_point</code> with its own (local) aesthetics.
</p>
<img src="WSBIM1207_files/figure-html/gg3-1.png" alt="Adding another `geom_point` with its own (local) aesthetics. " width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What do you think of the colours used to differentiate the different
runs above?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-3" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')"></span>
</p>
<div id="sol-body-3" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sec-vis.html#cb19-1"></a>gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">as.character</span>(Run)))</span></code></pre></div>
<div class="figure">
<span id="fig:ggex"></span>
<p class="caption marginnote shownote">
Figure 2.8: Setting the Run to a category by coercing it to a character, rather than a numeric.
</p>
<img src="WSBIM1207_files/figure-html/ggex-1.png" alt="Setting the Run to a category by coercing it to a character, rather than a numeric." width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Below is an example of more elaborated composition, overlaying points
and a non-linear <em>loess</em> regression. But first, let’s load a object
containing microarray data from the <code>hiiragi2013df1</code> data. The data is
originally available from the
<a href="http://bioconductor.org/packages/release/data/experiment/html/Hiiragi2013.html"><code>Hiiragi2013</code></a>
package and describes the cell-to-cell expression variability followed
by signal reinforcement progressively segregates early mouse lineages
<span class="citation">(Ohnishi et al. <label for="tufte-mn-12" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-12" class="margin-toggle">2014<span class="marginnote">Ohnishi, Y, W Huber, A Tsumura, M Kang, P Xenopoulos, K Kurimoto, A K Oleś, et al. 2014. “Cell-to-Cell Expression Variability Followed by Signal Reinforcement Progressively Segregates Early Mouse Lineages.” <em>Nat Cell Biol</em> 16 (1): 27–37. <a href="https://doi.org/10.1038/ncb2881">https://doi.org/10.1038/ncb2881</a>.</span>)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sec-vis.html#cb20-1"></a><span class="kw">library</span>(rWSBIM1322)</span>
<span id="cb20-2"><a href="sec-vis.html#cb20-2"></a><span class="kw">data</span>(hiiragi2013df1)</span>
<span id="cb20-3"><a href="sec-vis.html#cb20-3"></a><span class="kw">ggplot</span>(hiiragi2013df1, <span class="kw">aes</span>(<span class="dt">x =</span> X1426642_at, <span class="dt">y =</span> X1418765_at)) <span class="op">+</span></span>
<span id="cb20-4"><a href="sec-vis.html#cb20-4"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb20-5"><a href="sec-vis.html#cb20-5"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"loess"</span>)</span></code></pre></div>
<div class="figure">
<span id="fig:gg4"></span>
<p class="caption marginnote shownote">
Figure 2.9: Modelling the relation between the expression of X1426642_at and X1418765_at.
</p>
<img src="WSBIM1207_files/figure-html/gg4-1.png" alt="Modelling the relation between the expression of X1426642_at and X1418765_at." width="672">
</div>
<p>And, adding colours representing the different samples</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sec-vis.html#cb21-1"></a><span class="kw">ggplot</span>(hiiragi2013df1, <span class="kw">aes</span>(<span class="dt">x =</span> X1426642_at, <span class="dt">y =</span> X1418765_at))  <span class="op">+</span></span>
<span id="cb21-2"><a href="sec-vis.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> sampleColour), <span class="dt">shape =</span> <span class="dv">19</span>) <span class="op">+</span></span>
<span id="cb21-3"><a href="sec-vis.html#cb21-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">"loess"</span>)</span></code></pre></div>
<div class="figure">
<span id="fig:gg5"></span>
<p class="caption marginnote shownote">
Figure 2.10: Modelling the relation between the expression of X1426642_at and X1418765_at and annotating samples.
</p>
<img src="WSBIM1207_files/figure-html/gg5-1.png" alt="Modelling the relation between the expression of X1426642_at and X1418765_at and annotating samples." width="672">
</div>
</div>
<div id="visualising-1d-data" class="section level2">
<h2>
<span class="header-section-number">2.4</span> Visualising 1D data</h2>
<p>Let’s start by exploring some 1 dimensional visualisation. This is
very relevant for omics data such as transcriptomics or quantitative
proteomics, when contrasting the expression values across multiple
samples.</p>
<p>First, we convert a microarray gene expression data to a data.frame,
fit for some <code>ggplot2</code> visualisation, focusing on genes Fgf4, Gata4,
Gata6 and Sox2.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sec-vis.html#cb22-1"></a>selected_genes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Fgf4 =</span> <span class="st">"X1420085_at"</span>, <span class="dt">Gata4 =</span> <span class="st">"X1418863_at"</span>,</span>
<span id="cb22-2"><a href="sec-vis.html#cb22-2"></a>                    <span class="dt">Gata6 =</span> <span class="st">"X1425463_at"</span>,  <span class="dt">Sox2 =</span> <span class="st">"X1416967_at"</span>)</span>
<span id="cb22-3"><a href="sec-vis.html#cb22-3"></a>dfx &lt;-<span class="st"> </span>hiiragi2013df1[, selected_genes]</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sec-vis.html#cb23-1"></a><span class="kw">library</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb23-2"><a href="sec-vis.html#cb23-2"></a><span class="kw">library</span>(<span class="st">"tidyr"</span>)</span>
<span id="cb23-3"><a href="sec-vis.html#cb23-3"></a>genes &lt;-<span class="st"> </span><span class="kw">gather</span>(dfx, <span class="dt">key =</span> <span class="st">"gene"</span>, <span class="dt">value =</span> <span class="st">"expression"</span>)</span>
<span id="cb23-4"><a href="sec-vis.html#cb23-4"></a><span class="kw">head</span>(genes)</span></code></pre></div>
<pre><code>##          gene expression
## 1 X1420085_at   3.027715
## 2 X1420085_at   9.293016
## 3 X1420085_at   2.940142
## 4 X1420085_at   9.715243
## 5 X1420085_at   8.924228
## 6 X1420085_at  11.325952</code></pre>
<div id="histogram" class="section level3">
<h3>
<span class="header-section-number">2.4.1</span> Histogram</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sec-vis.html#cb25-1"></a>genes <span class="op">%&gt;%</span></span>
<span id="cb25-2"><a href="sec-vis.html#cb25-2"></a><span class="st">    </span><span class="kw">filter</span>(gene <span class="op">==</span><span class="st"> "Gata4"</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="sec-vis.html#cb25-3"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> expression)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:hist"></span>
<p class="caption marginnote shownote">
Figure 2.11: Distribution of the Gata4 expression
</p>
<img src="WSBIM1207_files/figure-html/hist-1.png" alt="Distribution of the Gata4 expression" width="672">
</div>
</div>
<div id="box-plots" class="section level3">
<h3>
<span class="header-section-number">2.4.2</span> Box plots</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sec-vis.html#cb26-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(genes, <span class="kw">aes</span>(<span class="dt">x =</span> gene, <span class="dt">y =</span> expression, <span class="dt">fill =</span> gene))</span>
<span id="cb26-2"><a href="sec-vis.html#cb26-2"></a>bxplot &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span>
<span id="cb26-3"><a href="sec-vis.html#cb26-3"></a>bxplot</span></code></pre></div>
<div class="figure">
<span id="fig:boxplot"></span>
<p class="caption marginnote shownote">
Figure 2.12: A boxplot of expression values.
</p>
<img src="WSBIM1207_files/figure-html/boxplot-1.png" alt="A boxplot of expression values." width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Repeat the above figure replacing the boxes by violins using the
<code>geom_violin</code>. Which one do you think does a better job?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-4" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')"></span>
</p>
<div id="sol-body-4" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sec-vis.html#cb27-1"></a>vlnplot &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_violin</span>()</span>
<span id="cb27-2"><a href="sec-vis.html#cb27-2"></a>vlnplot</span></code></pre></div>
<div class="figure">
<span id="fig:violin"></span>
<p class="caption marginnote shownote">
Figure 2.13: A violin plot of expression values.
</p>
<img src="WSBIM1207_files/figure-html/violin-1.png" alt="A violin plot of expression values." width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="dot-plots-and-beeswarm-plots" class="section level3">
<h3>
<span class="header-section-number">2.4.3</span> Dot plots and beeswarm plots</h3>
<p>When the data aren’t too large, it is also possibly to visualise all
points to get a sense of their distribution.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sec-vis.html#cb28-1"></a>jtrplot &lt;-<span class="st"> </span>p <span class="op">+</span></span>
<span id="cb28-2"><a href="sec-vis.html#cb28-2"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> gene)) <span class="op">+</span></span>
<span id="cb28-3"><a href="sec-vis.html#cb28-3"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div>
<p>In a dotplot, the position of the points along the y axis is
discretised into bins (set as 1/6 below) and the points are then
stacked next to each other.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sec-vis.html#cb29-1"></a>dotplot &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis =</span> <span class="st">"y"</span>, <span class="dt">binwidth =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>,</span>
<span id="cb29-2"><a href="sec-vis.html#cb29-2"></a>                            <span class="dt">stackdir =</span> <span class="st">"center"</span>, <span class="dt">stackratio =</span> <span class="fl">0.75</span>,</span>
<span id="cb29-3"><a href="sec-vis.html#cb29-3"></a>                            <span class="kw">aes</span>(<span class="dt">color =</span> gene)) <span class="op">+</span></span>
<span id="cb29-4"><a href="sec-vis.html#cb29-4"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div>
<p>The beeswarm algorithms tries to avoid overlapping points.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sec-vis.html#cb30-1"></a><span class="kw">library</span>(<span class="st">"ggbeeswarm"</span>)</span>
<span id="cb30-2"><a href="sec-vis.html#cb30-2"></a>beeplot &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_beeswarm</span>(<span class="kw">aes</span>(<span class="dt">color =</span> gene)) <span class="op">+</span></span>
<span id="cb30-3"><a href="sec-vis.html#cb30-3"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sec-vis.html#cb31-1"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb31-2"><a href="sec-vis.html#cb31-2"></a>jtrplot <span class="op">+</span><span class="st"> </span>dotplot <span class="op">+</span><span class="st"> </span>beeplot</span></code></pre></div>
<div class="figure">
<span id="fig:showdots"></span>
<p class="caption marginnote shownote">
Figure 2.14: Showing all expression values using jittering (left), a dotplot (centre) and a beeswarn plot.
</p>
<img src="WSBIM1207_files/figure-html/showdots-1.png" alt="Showing all expression values using jittering (left), a dotplot (centre) and a beeswarn plot." width="672">
</div>
</div>
<div id="density-and-ecdf-plots" class="section level3">
<h3>
<span class="header-section-number">2.4.4</span> Density and ecdf plots</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sec-vis.html#cb32-1"></a>densplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(genes, <span class="kw">aes</span>(<span class="dt">x =</span> expression, <span class="dt">color =</span> gene)) <span class="op">+</span></span>
<span id="cb32-2"><a href="sec-vis.html#cb32-2"></a><span class="st">    </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb32-3"><a href="sec-vis.html#cb32-3"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sec-vis.html#cb33-1"></a>ecdfplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(genes, <span class="kw">aes</span>(<span class="dt">x =</span> expression, <span class="dt">color =</span> gene)) <span class="op">+</span></span>
<span id="cb33-2"><a href="sec-vis.html#cb33-2"></a><span class="st">    </span><span class="kw">stat_ecdf</span>() <span class="op">+</span></span>
<span id="cb33-3"><a href="sec-vis.html#cb33-3"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sec-vis.html#cb34-1"></a>densplot <span class="op">+</span><span class="st"> </span>ecdfplot</span></code></pre></div>
<div class="figure">
<span id="fig:unnamed-chunk-3"></span>
<p class="caption marginnote shownote">
Figure 2.15: Density and cumulative density functions of expression values.
</p>
<img src="WSBIM1207_files/figure-html/unnamed-chunk-3-1.png" alt="Density and cumulative density functions of expression values." width="672">
</div>
</div>
<div id="summary" class="section level3">
<h3>
<span class="header-section-number">2.4.5</span> Summary</h3>
<ul>
<li><p><strong>Boxplot</strong> makes sense for unimodal distributions (see below).</p></li>
<li><p><strong>Histogram</strong> requires definition of bins (width, positions) and can
create visual artefacts especially if the number of data points is
not large.</p></li>
<li><p><strong>Density</strong> requires the choice of bandwidth; obscures the sample
size (i.e. the uncertainty of the estimate).</p></li>
<li><p><strong>ecdf</strong> does not have these problems; but is more abstract and
interpretation requires more training. Good for reading off
quantiles and shifts in location in comparative plots.</p></li>
<li><p><strong>beeswarm</strong>: for up to a few dozens of points, just show the data.</p></li>
</ul>
</div>
</div>
<div id="number-of-modes" class="section level2">
<h2>
<span class="header-section-number">2.5</span> Number of modes</h2>
<p>The number of modes of a distribution depends on scale transformation
of the data.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sec-vis.html#cb35-1"></a>sim &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">exp</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="fl">1e5</span>,</span>
<span id="cb35-2"><a href="sec-vis.html#cb35-2"></a>                                <span class="dt">mean =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>),</span>
<span id="cb35-3"><a href="sec-vis.html#cb35-3"></a>                                              <span class="dt">size =</span> <span class="fl">1e5</span>,</span>
<span id="cb35-4"><a href="sec-vis.html#cb35-4"></a>                                              <span class="dt">replace =</span> <span class="ot">TRUE</span>))))</span>
<span id="cb35-5"><a href="sec-vis.html#cb35-5"></a></span>
<span id="cb35-6"><a href="sec-vis.html#cb35-6"></a>p1 &lt;-<span class="st">  </span><span class="kw">ggplot</span>(sim, <span class="kw">aes</span>(x)) <span class="op">+</span></span>
<span id="cb35-7"><a href="sec-vis.html#cb35-7"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb35-8"><a href="sec-vis.html#cb35-8"></a><span class="st">    </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">400</span>)</span>
<span id="cb35-9"><a href="sec-vis.html#cb35-9"></a>p2 &lt;-<span class="st">  </span><span class="kw">ggplot</span>(sim, <span class="kw">aes</span>(<span class="kw">log</span>(x))) <span class="op">+</span></span>
<span id="cb35-10"><a href="sec-vis.html#cb35-10"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>)</span>
<span id="cb35-11"><a href="sec-vis.html#cb35-11"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<div class="figure">
<span id="fig:sim"></span>
<p class="caption marginnote shownote">
Figure 2.16: Histograms of the same data without (left) and with (right) log-transformation.
</p>
<img src="WSBIM1207_files/figure-html/sim-1.png" alt="Histograms of the same data without (left) and with (right) log-transformation." width="672">
</div>
<p>This also applies to density plots.</p>
</div>
<div id="visualising-2d-data" class="section level2">
<h2>
<span class="header-section-number">2.6</span> Visualising 2D data</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sec-vis.html#cb36-1"></a><span class="kw">data</span>(hiiragi2013df2)</span>
<span id="cb36-2"><a href="sec-vis.html#cb36-2"></a><span class="kw">head</span>(hiiragi2013df2)</span></code></pre></div>
<pre><code>##              59 E4.5 (PE) 92 E4.5 (FGF4-KO)
## 1415670_at       9.503289          8.359740
## 1415671_at      11.458339         11.175453
## 1415672_at       6.699087         10.885286
## 1415673_at       6.765473          4.957310
## 1415674_a_at     9.974538          8.592410
## 1415675_at       9.294144          6.257513</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sec-vis.html#cb38-1"></a>scp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(hiiragi2013df2,</span>
<span id="cb38-2"><a href="sec-vis.html#cb38-2"></a>              <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">`</span><span class="dt">59 E4.5 (PE)</span><span class="st">`</span>,</span>
<span id="cb38-3"><a href="sec-vis.html#cb38-3"></a>                  <span class="dt">y =</span> <span class="st">`</span><span class="dt">92 E4.5 (FGF4-KO)</span><span class="st">`</span>))</span>
<span id="cb38-4"><a href="sec-vis.html#cb38-4"></a>scp <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:sc1"></span>
<p class="caption marginnote shownote">
Figure 2.17: Scatter plot comparing the expression of a wild-type vs. FGF4 KO.
</p>
<img src="WSBIM1207_files/figure-html/sc1-1.png" alt="Scatter plot comparing the expression of a wild-type vs. FGF4 KO." width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>The over-plotting of the dots stops us from learning anything about
the density of the different regions of the plot. Use the <code>alpha</code>
parameter to <code>geom_points</code> between 0 (full transparency) to 1 (opaque,
default).</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-5" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')"></span>
</p>
<div id="sol-body-5" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="sec-vis.html#cb39-1"></a>scp <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure">
<span id="fig:scp2"></span>
<p class="caption marginnote shownote">
Figure 2.18: Transparency can help distinguish regions of different densities.
</p>
<img src="WSBIM1207_files/figure-html/scp2-1.png" alt="Transparency can help distinguish regions of different densities." width="672">
</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sec-vis.html#cb40-1"></a>scp <span class="op">+</span><span class="st"> </span><span class="kw">geom_density2d</span>(<span class="dt">h =</span> <span class="fl">0.5</span>, <span class="dt">bins =</span> <span class="dv">60</span>)</span></code></pre></div>
<div class="figure">
<span id="fig:scp3"></span>
<p class="caption marginnote shownote">
Figure 2.19: Focusing on contours rather that individual values.
</p>
<img src="WSBIM1207_files/figure-html/scp3-1.png" alt="Focusing on contours rather that individual values." width="672">
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sec-vis.html#cb41-1"></a>scp <span class="op">+</span><span class="st"> </span><span class="kw">geom_hex</span>()</span></code></pre></div>
<div class="figure">
<span id="fig:scp5"></span>
<p class="caption marginnote shownote">
Figure 2.20: Local density summaries.
</p>
<img src="WSBIM1207_files/figure-html/scp5-1.png" alt="Local density summaries." width="672">
</div>
</div>
<div id="visualising-data-along-more-dimensions" class="section level2">
<h2>
<span class="header-section-number">2.7</span> Visualising data along more dimensions</h2>
<p>When visualising data along additional dimension, we can parameterise
the points by setting their shape, colour, size and transparency, that
can be set with point aesthetics such as <code>fill</code>, <code>color</code> (or
<code>colour</code>), <code>shape</code>, <code>size</code> and <code>alpha</code>.</p>
<p>A very powerful way to represent data along additional dimensions is
facetting, i.e. producing sub-plots for different subsets of the
data. Below, we first re-annotate the data using some regular
expressions</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sec-vis.html#cb42-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(hiiragi2013df1, <span class="kw">aes</span>(<span class="dt">x =</span> X1426642_at, <span class="dt">y =</span> X1418765_at, <span class="dt">colour =</span> lineage)) <span class="op">+</span></span>
<span id="cb42-2"><a href="sec-vis.html#cb42-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb42-3"><a href="sec-vis.html#cb42-3"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(hiiragi2013df1, <span class="kw">aes</span>(<span class="dt">x =</span> X1426642_at, <span class="dt">y =</span> X1418765_at)) <span class="op">+</span></span>
<span id="cb42-4"><a href="sec-vis.html#cb42-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb42-5"><a href="sec-vis.html#cb42-5"></a><span class="st">    </span><span class="kw">facet_grid</span>( . <span class="op">~</span><span class="st"> </span>lineage )</span>
<span id="cb42-6"><a href="sec-vis.html#cb42-6"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<div class="figure">
<span id="fig:facet1"></span>
<p class="caption marginnote shownote">
Figure 2.21: Different sub-plots for different lineages using colours (left) of facets (right) to distinguish the different lineages.
</p>
<img src="WSBIM1207_files/figure-html/facet1-1.png" alt="Different sub-plots for different lineages using colours (left) of facets (right) to distinguish the different lineages." width="672">
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sec-vis.html#cb43-1"></a><span class="kw">ggplot</span>(hiiragi2013df1,</span>
<span id="cb43-2"><a href="sec-vis.html#cb43-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> X1426642_at, <span class="dt">y =</span> X1418765_at)) <span class="op">+</span></span>
<span id="cb43-3"><a href="sec-vis.html#cb43-3"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb43-4"><a href="sec-vis.html#cb43-4"></a><span class="st">    </span><span class="kw">facet_grid</span>( Embryonic.day <span class="op">~</span><span class="st"> </span>lineage )</span></code></pre></div>
<div class="figure">
<span id="fig:facet2"></span>
<p class="caption marginnote shownote">
Figure 2.22: Different sub-plots for different lineages and embryonic stages.
</p>
<img src="WSBIM1207_files/figure-html/facet2-1.png" alt="Different sub-plots for different lineages and embryonic stages." width="672">
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Use facets to visualise the distribution of the four Fgf4, Gata4,
Gata6 and Sox2 genes in the <code>genes</code> data using histograms.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-6" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')"></span>
</p>
<div id="sol-body-6" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sec-vis.html#cb44-1"></a><span class="kw">ggplot</span>(genes, <span class="kw">aes</span>(<span class="dt">x =</span> expression)) <span class="op">+</span></span>
<span id="cb44-2"><a href="sec-vis.html#cb44-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb44-3"><a href="sec-vis.html#cb44-3"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gene)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="WSBIM1207_files/figure-html/hist2-1.png" width="672"></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="interactive-visualisation" class="section level2">
<h2>
<span class="header-section-number">2.8</span> Interactive visualisation</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sec-vis.html#cb46-1"></a><span class="kw">library</span>(<span class="st">"plotly"</span>)</span>
<span id="cb46-2"><a href="sec-vis.html#cb46-2"></a></span>
<span id="cb46-3"><a href="sec-vis.html#cb46-3"></a>scp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(hiiragi2013df2[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ],</span>
<span id="cb46-4"><a href="sec-vis.html#cb46-4"></a>              <span class="kw">aes</span>(<span class="dt">x=</span> <span class="st">`</span><span class="dt">59 E4.5 (PE)</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">92 E4.5 (FGF4-KO)</span><span class="st">`</span>))</span>
<span id="cb46-5"><a href="sec-vis.html#cb46-5"></a></span>
<span id="cb46-6"><a href="sec-vis.html#cb46-6"></a>scp2 &lt;-<span class="st"> </span>scp <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span>
<span id="cb46-7"><a href="sec-vis.html#cb46-7"></a><span class="kw">ggplotly</span>(scp2)</span></code></pre></div>
<div class="figure">
<span id="fig:plotly"></span>
<div id="htmlwidget-260dc415b7045d3ed600" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-260dc415b7045d3ed600">{"x":{"data":[{"x":[9.50328885761698,11.4583388980142,6.69908714102452,6.76547310177842,9.97453827442252,9.29414407114785,11.2425791931273,6.00365318140821,9.69084697239434,11.2546439963636,9.41759145128669,10.1596369374599,10.0095170810996,8.6915193209578,3.51483400178731,3.32016551205821,9.68542658312472,7.10788970698342,8.26083745590347,3.3472256351445,10.5588808046187,3.39798718687798,9.96999864183363,9.09015789861251,6.62751361884912,10.2632791620306,10.4547237609518,8.41367652914721,9.38614117119767,11.5126581959952,10.9892162414557,13.7193329315183,9.45233086619772,10.7239071614169,10.9247552024502,8.22326945744881,11.9877858916837,8.05941745175425,10.3247959634513,9.10927177465464,10.2786914869951,10.199343558233,7.12560547665524,8.25232268875857,9.74245851101964,6.22538652600791,13.1431749824957,8.95377921615317,9.03425101684634,8.47419879870503,10.2787823668076,8.88764618598608,7.85959533058495,9.57456638449976,10.7596501708924,8.26771968767381,9.32997481751462,9.42895567614123,9.13681351227292,7.62222715379513,9.25737638196604,9.2861654757841,6.50158311442964,10.6681180210201,10.9254268371571,12.3327556888521,9.01159111050395,8.63288284332899,11.961275122056,9.94374018972265,10.9032833119333,9.5806168166528,9.38556921018976,6.37997263569094,8.43348613955656,8.91753508429681,7.2469707110782,10.2099565869907,5.45767878658488,10.3574798619498,8.34834949607628,7.29231005769297,10.6783005252936,9.07684982838406,9.7014798873381,10.8948035781619,5.41937439627213,9.40686967141902,3.28105208427137,9.91134889955347,12.4413343774209,10.0664495702583,9.79647676637397,9.34690333915207,10.373060125206,5.74686020763486,7.7384202690513,8.75189517456831,8.64993564082344,6.81912346713591],"y":[8.35974037298477,11.1754527273294,10.8852862674491,4.95731011889329,8.59240978195337,6.25751335112741,10.6360503126818,4.7547119429375,6.21750173115361,9.34767228671418,4.34522522419689,4.40247758201114,8.91776686781407,7.75276827889423,4.27532635811445,2.82666654275168,4.25389777635767,9.22701734721057,4.57703652665421,2.46231923635121,9.6673764258353,4.40247758201114,6.69821250492852,6.50070684317122,7.52393103680274,8.37160465508127,5.92966659900935,9.54184083527792,4.92341876572098,9.3188533981018,8.54270976898661,13.7768119134285,8.99048920526181,9.79297750833707,9.64405453243467,5.23758905295884,9.07556167583394,3.17017680163412,3.19737381239321,4.48453001199514,9.0571394824515,10.3557321006169,3.33223741236221,5.43175946550192,11.7355320764186,4.44184838634889,12.4943748753513,9.50028202313971,9.2032592057655,4.50157627674841,6.06571997985005,10.0421391355471,9.37080344439977,10.0176403198372,6.63359645324598,9.17220503282378,3.87868864387789,5.90196717598251,9.47039162922733,8.03958749478747,6.43058300417503,5.17254495077387,6.91877024827856,11.0026280799714,10.0605316061927,11.8420558885026,9.71111284303523,10.587880371329,9.34341401599287,9.70944401437105,9.2097696923654,9.76669289021524,7.4937849259359,7.41128212791976,9.23012052749121,6.47790597459809,9.09508719734669,9.31250049421885,8.29765158803413,8.73715496860086,7.97532251928253,3.9607235163743,6.14880947052974,7.75025820019549,11.1455471974395,9.98818798994107,4.00315500335281,6.07954067819613,7.61179560561352,9.95122932076613,7.50553776495265,8.6389767238562,8.40562082697378,9.92563750640456,7.72958422525337,9.23934862730098,4.43991567697381,4.74327031317631,6.91160280757701,5.87335030799528],"text":["59 E4.5 (PE):  9.503289<br />92 E4.5 (FGF4-KO):  8.359740","59 E4.5 (PE): 11.458339<br />92 E4.5 (FGF4-KO): 11.175453","59 E4.5 (PE):  6.699087<br />92 E4.5 (FGF4-KO): 10.885286","59 E4.5 (PE):  6.765473<br />92 E4.5 (FGF4-KO):  4.957310","59 E4.5 (PE):  9.974538<br />92 E4.5 (FGF4-KO):  8.592410","59 E4.5 (PE):  9.294144<br />92 E4.5 (FGF4-KO):  6.257513","59 E4.5 (PE): 11.242579<br />92 E4.5 (FGF4-KO): 10.636050","59 E4.5 (PE):  6.003653<br />92 E4.5 (FGF4-KO):  4.754712","59 E4.5 (PE):  9.690847<br />92 E4.5 (FGF4-KO):  6.217502","59 E4.5 (PE): 11.254644<br />92 E4.5 (FGF4-KO):  9.347672","59 E4.5 (PE):  9.417591<br />92 E4.5 (FGF4-KO):  4.345225","59 E4.5 (PE): 10.159637<br />92 E4.5 (FGF4-KO):  4.402478","59 E4.5 (PE): 10.009517<br />92 E4.5 (FGF4-KO):  8.917767","59 E4.5 (PE):  8.691519<br />92 E4.5 (FGF4-KO):  7.752768","59 E4.5 (PE):  3.514834<br />92 E4.5 (FGF4-KO):  4.275326","59 E4.5 (PE):  3.320166<br />92 E4.5 (FGF4-KO):  2.826667","59 E4.5 (PE):  9.685427<br />92 E4.5 (FGF4-KO):  4.253898","59 E4.5 (PE):  7.107890<br />92 E4.5 (FGF4-KO):  9.227017","59 E4.5 (PE):  8.260837<br />92 E4.5 (FGF4-KO):  4.577037","59 E4.5 (PE):  3.347226<br />92 E4.5 (FGF4-KO):  2.462319","59 E4.5 (PE): 10.558881<br />92 E4.5 (FGF4-KO):  9.667376","59 E4.5 (PE):  3.397987<br />92 E4.5 (FGF4-KO):  4.402478","59 E4.5 (PE):  9.969999<br />92 E4.5 (FGF4-KO):  6.698213","59 E4.5 (PE):  9.090158<br />92 E4.5 (FGF4-KO):  6.500707","59 E4.5 (PE):  6.627514<br />92 E4.5 (FGF4-KO):  7.523931","59 E4.5 (PE): 10.263279<br />92 E4.5 (FGF4-KO):  8.371605","59 E4.5 (PE): 10.454724<br />92 E4.5 (FGF4-KO):  5.929667","59 E4.5 (PE):  8.413677<br />92 E4.5 (FGF4-KO):  9.541841","59 E4.5 (PE):  9.386141<br />92 E4.5 (FGF4-KO):  4.923419","59 E4.5 (PE): 11.512658<br />92 E4.5 (FGF4-KO):  9.318853","59 E4.5 (PE): 10.989216<br />92 E4.5 (FGF4-KO):  8.542710","59 E4.5 (PE): 13.719333<br />92 E4.5 (FGF4-KO): 13.776812","59 E4.5 (PE):  9.452331<br />92 E4.5 (FGF4-KO):  8.990489","59 E4.5 (PE): 10.723907<br />92 E4.5 (FGF4-KO):  9.792978","59 E4.5 (PE): 10.924755<br />92 E4.5 (FGF4-KO):  9.644055","59 E4.5 (PE):  8.223269<br />92 E4.5 (FGF4-KO):  5.237589","59 E4.5 (PE): 11.987786<br />92 E4.5 (FGF4-KO):  9.075562","59 E4.5 (PE):  8.059417<br />92 E4.5 (FGF4-KO):  3.170177","59 E4.5 (PE): 10.324796<br />92 E4.5 (FGF4-KO):  3.197374","59 E4.5 (PE):  9.109272<br />92 E4.5 (FGF4-KO):  4.484530","59 E4.5 (PE): 10.278691<br />92 E4.5 (FGF4-KO):  9.057139","59 E4.5 (PE): 10.199344<br />92 E4.5 (FGF4-KO): 10.355732","59 E4.5 (PE):  7.125605<br />92 E4.5 (FGF4-KO):  3.332237","59 E4.5 (PE):  8.252323<br />92 E4.5 (FGF4-KO):  5.431759","59 E4.5 (PE):  9.742459<br />92 E4.5 (FGF4-KO): 11.735532","59 E4.5 (PE):  6.225387<br />92 E4.5 (FGF4-KO):  4.441848","59 E4.5 (PE): 13.143175<br />92 E4.5 (FGF4-KO): 12.494375","59 E4.5 (PE):  8.953779<br />92 E4.5 (FGF4-KO):  9.500282","59 E4.5 (PE):  9.034251<br />92 E4.5 (FGF4-KO):  9.203259","59 E4.5 (PE):  8.474199<br />92 E4.5 (FGF4-KO):  4.501576","59 E4.5 (PE): 10.278782<br />92 E4.5 (FGF4-KO):  6.065720","59 E4.5 (PE):  8.887646<br />92 E4.5 (FGF4-KO): 10.042139","59 E4.5 (PE):  7.859595<br />92 E4.5 (FGF4-KO):  9.370803","59 E4.5 (PE):  9.574566<br />92 E4.5 (FGF4-KO): 10.017640","59 E4.5 (PE): 10.759650<br />92 E4.5 (FGF4-KO):  6.633596","59 E4.5 (PE):  8.267720<br />92 E4.5 (FGF4-KO):  9.172205","59 E4.5 (PE):  9.329975<br />92 E4.5 (FGF4-KO):  3.878689","59 E4.5 (PE):  9.428956<br />92 E4.5 (FGF4-KO):  5.901967","59 E4.5 (PE):  9.136814<br />92 E4.5 (FGF4-KO):  9.470392","59 E4.5 (PE):  7.622227<br />92 E4.5 (FGF4-KO):  8.039587","59 E4.5 (PE):  9.257376<br />92 E4.5 (FGF4-KO):  6.430583","59 E4.5 (PE):  9.286165<br />92 E4.5 (FGF4-KO):  5.172545","59 E4.5 (PE):  6.501583<br />92 E4.5 (FGF4-KO):  6.918770","59 E4.5 (PE): 10.668118<br />92 E4.5 (FGF4-KO): 11.002628","59 E4.5 (PE): 10.925427<br />92 E4.5 (FGF4-KO): 10.060532","59 E4.5 (PE): 12.332756<br />92 E4.5 (FGF4-KO): 11.842056","59 E4.5 (PE):  9.011591<br />92 E4.5 (FGF4-KO):  9.711113","59 E4.5 (PE):  8.632883<br />92 E4.5 (FGF4-KO): 10.587880","59 E4.5 (PE): 11.961275<br />92 E4.5 (FGF4-KO):  9.343414","59 E4.5 (PE):  9.943740<br />92 E4.5 (FGF4-KO):  9.709444","59 E4.5 (PE): 10.903283<br />92 E4.5 (FGF4-KO):  9.209770","59 E4.5 (PE):  9.580617<br />92 E4.5 (FGF4-KO):  9.766693","59 E4.5 (PE):  9.385569<br />92 E4.5 (FGF4-KO):  7.493785","59 E4.5 (PE):  6.379973<br />92 E4.5 (FGF4-KO):  7.411282","59 E4.5 (PE):  8.433486<br />92 E4.5 (FGF4-KO):  9.230121","59 E4.5 (PE):  8.917535<br />92 E4.5 (FGF4-KO):  6.477906","59 E4.5 (PE):  7.246971<br />92 E4.5 (FGF4-KO):  9.095087","59 E4.5 (PE): 10.209957<br />92 E4.5 (FGF4-KO):  9.312500","59 E4.5 (PE):  5.457679<br />92 E4.5 (FGF4-KO):  8.297652","59 E4.5 (PE): 10.357480<br />92 E4.5 (FGF4-KO):  8.737155","59 E4.5 (PE):  8.348349<br />92 E4.5 (FGF4-KO):  7.975323","59 E4.5 (PE):  7.292310<br />92 E4.5 (FGF4-KO):  3.960724","59 E4.5 (PE): 10.678301<br />92 E4.5 (FGF4-KO):  6.148809","59 E4.5 (PE):  9.076850<br />92 E4.5 (FGF4-KO):  7.750258","59 E4.5 (PE):  9.701480<br />92 E4.5 (FGF4-KO): 11.145547","59 E4.5 (PE): 10.894804<br />92 E4.5 (FGF4-KO):  9.988188","59 E4.5 (PE):  5.419374<br />92 E4.5 (FGF4-KO):  4.003155","59 E4.5 (PE):  9.406870<br />92 E4.5 (FGF4-KO):  6.079541","59 E4.5 (PE):  3.281052<br />92 E4.5 (FGF4-KO):  7.611796","59 E4.5 (PE):  9.911349<br />92 E4.5 (FGF4-KO):  9.951229","59 E4.5 (PE): 12.441334<br />92 E4.5 (FGF4-KO):  7.505538","59 E4.5 (PE): 10.066450<br />92 E4.5 (FGF4-KO):  8.638977","59 E4.5 (PE):  9.796477<br />92 E4.5 (FGF4-KO):  8.405621","59 E4.5 (PE):  9.346903<br />92 E4.5 (FGF4-KO):  9.925638","59 E4.5 (PE): 10.373060<br />92 E4.5 (FGF4-KO):  7.729584","59 E4.5 (PE):  5.746860<br />92 E4.5 (FGF4-KO):  9.239349","59 E4.5 (PE):  7.738420<br />92 E4.5 (FGF4-KO):  4.439916","59 E4.5 (PE):  8.751895<br />92 E4.5 (FGF4-KO):  4.743270","59 E4.5 (PE):  8.649936<br />92 E4.5 (FGF4-KO):  6.911603","59 E4.5 (PE):  6.819123<br />92 E4.5 (FGF4-KO):  5.873350"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.75913804190903,14.2412469738806],"tickmode":"array","ticktext":["3","6","9","12"],"tickvals":[3,6,9,12],"categoryorder":"array","categoryarray":["3","6","9","12"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"59 E4.5 (PE)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.89659460249735,14.3425365472823],"tickmode":"array","ticktext":["5","10"],"tickvals":[5,10],"categoryorder":"array","categoryarray":["5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"92 E4.5 (FGF4-KO)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"70f6d0684fc":{"x":{},"y":{},"type":"scatter"}},"cur_data":"70f6d0684fc","visdat":{"70f6d0684fc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption marginnote shownote">
Figure 2.23: Interactive visualisation with plotly
</p>
</div>
<p>See <a href="https://plot.ly/r" class="uri">https://plot.ly/r</a> for examples of interactive graphics online.</p>
</div>
<div id="additional-exercises" class="section level2">
<h2>
<span class="header-section-number">2.9</span> Additional exercises</h2>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Load the <code>barley</code> data that comes with the <code>lattice</code> package (that is
already installed on your computer). The data describe the yield from
a Minnesota barley trial as a data frame with 120 observations on the
following 4 variables.</p>
<ul>
<li><p><code>yield</code> Yield (averaged across three blocks) in bushels/acre.</p></li>
<li><p><code>variety</code> Factor with levels <code>Svansota</code>, <code>No. 462</code>, <code>Manchuria</code>,
<code>No. 475</code>, <code>Velvet</code>, <code>Peatland</code>, <code>Glabron</code>, <code>No. 457</code>,<code>Wisconsin No. 38</code>, <code>Trebi</code>.</p></li>
<li><p><code>year</code> Factor with levels <code>1932</code> and <code>1931</code>.</p></li>
<li><p><code>site</code> Factor with 6 levels: <code>Grand Rapids</code>, <code>Duluth</code>,
<code>University Farm</code>, <code>Morris</code>, <code>Crookston</code>, <code>Waseca</code>.</p></li>
</ul>
<p>Familiarise yourself with the data</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Visualise the yield for each variety on all site in 1932 and 1931
using <code>ggplot2</code>. Try to generate a figure on your own. If you
struggle, discuss with your fellow students. If you need additional
help, or as a check, execute the code in the <code>barley</code> manual page
example.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Can you spot an issue with the data?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div></body></html>

<p style="text-align: center;">
<a href="sec-refresher.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-obj.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2019-09-06
</p>
</div>
</div>



</body>
</html>
